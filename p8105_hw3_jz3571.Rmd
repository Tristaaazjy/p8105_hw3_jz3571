---
title: "p8105_hw3_jz3571"
author: "Junyan Zhu"
date: "2022-10-16"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE}
library(tidyverse)
library(dplyr)
library(patchwork)
library(ggplot2)

```

# Problem 1

```{r}
library(p8105.datasets)
data("instacart")
summary(instacart)
insta_df = instacart
```

## How many aisles are there and which aisles are the most items ordered from?
```{r}
num_aisle = insta_df %>% 
  group_by(aisle) %>% 
  summarise(total_num = n()) %>% 
  arrange(desc(total_num))

nrow(num_aisle)

names(which.max(table(insta_df$aisle)))

```

```{r}
num_aisle %>% 
  filter(total_num > 10000) %>% 
  ggplot() +
  geom_bar(aes(x = total_num, y = aisle), stat = "identity") +
  labs(title = "Number of Orders for Different Aisles",
       x = "Type of Aisel",
       y = "Number of Order") +
  theme_classic()
```

```{r}
three_pop_df = insta_df %>% 
  filter(aisle == c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle, product_name) %>% 
  summarise(count = n()) %>% 
  mutate(rank = min_rank(desc(count))) %>% 
  filter(rank <= 3) %>% 
  arrange(aisle, rank)

three_pop_df
```

```{r}
mean_hr_df = insta_df %>% 
  filter(product_name %in% c("Pink Lady Apples", 'Coffee Ice Cream')) %>% 
  select(order_dow, order_hour_of_day, product_name) %>% 
  group_by(order_dow, product_name) %>% 
  summarise(mean(order_hour_of_day)) %>% 
  mutate(order_dow = recode(order_dow,
                            '0' = 'Sunday',
                            '1' = 'Monday',
                            '2' = 'Tuesday',
                            '3' = 'Wednesday',
                            '4' = 'Thursday',
                            '5' = 'Friday',
                            '6' = 'Saturday'))

mean_hr_df
```

# Problem 2

```{r}
acc_df = read_csv("./data/accel_data.csv") %>% 
  janitor::clean_names()
```

## Load, tidy, and otherwise wrangle the data. Your final dataset should include all originally observed variables and values; have useful variable names; include a weekday vs weekend variable; and encode data with reasonable variable classes. Describe the resulting dataset (e.g. what variables exist, how many observations, etc).

```{r}
tidy_acc_df = acc_df %>% 
  mutate(weekdays = ifelse(day == "Saturday" | day =="Sunday", 'weekend', 'weekday')) %>% 
  mutate(activity_daysum = rowSums(.[4:1443]))
```

There are total 35 days of observations and 1443 variables exist, including week, day, day-id, and 1440 variables for each minute in a day. The new created weekdays variable specifies whether a recorded day belongs to weekday or weekend, and activity_daysum variable reflects the total activity count for a specific day by summing all 1440 counts for a day.
