p8105_hw3_jz3571
================
Junyan Zhu
2022-10-16

``` r
library(tidyverse)
library(dplyr)
library(patchwork)
library(ggplot2)
```

# Problem 1

``` r
library(p8105.datasets)
data("instacart")
summary(instacart)
```

    ##     order_id         product_id    add_to_cart_order   reordered     
    ##  Min.   :      1   Min.   :    1   Min.   : 1.000    Min.   :0.0000  
    ##  1st Qu.: 843370   1st Qu.:13380   1st Qu.: 3.000    1st Qu.:0.0000  
    ##  Median :1701880   Median :25298   Median : 7.000    Median :1.0000  
    ##  Mean   :1706298   Mean   :25556   Mean   : 8.758    Mean   :0.5986  
    ##  3rd Qu.:2568023   3rd Qu.:37940   3rd Qu.:12.000    3rd Qu.:1.0000  
    ##  Max.   :3421070   Max.   :49688   Max.   :80.000    Max.   :1.0000  
    ##     user_id         eval_set          order_number      order_dow    
    ##  Min.   :     1   Length:1384617     Min.   :  4.00   Min.   :0.000  
    ##  1st Qu.: 51732   Class :character   1st Qu.:  6.00   1st Qu.:1.000  
    ##  Median :102933   Mode  :character   Median : 11.00   Median :3.000  
    ##  Mean   :103113                      Mean   : 17.09   Mean   :2.701  
    ##  3rd Qu.:154959                      3rd Qu.: 21.00   3rd Qu.:5.000  
    ##  Max.   :206209                      Max.   :100.00   Max.   :6.000  
    ##  order_hour_of_day days_since_prior_order product_name          aisle_id    
    ##  Min.   : 0.00     Min.   : 0.00          Length:1384617     Min.   :  1.0  
    ##  1st Qu.:10.00     1st Qu.: 7.00          Class :character   1st Qu.: 31.0  
    ##  Median :14.00     Median :15.00          Mode  :character   Median : 83.0  
    ##  Mean   :13.58     Mean   :17.07                             Mean   : 71.3  
    ##  3rd Qu.:17.00     3rd Qu.:30.00                             3rd Qu.:107.0  
    ##  Max.   :23.00     Max.   :30.00                             Max.   :134.0  
    ##  department_id      aisle            department       
    ##  Min.   : 1.00   Length:1384617     Length:1384617    
    ##  1st Qu.: 4.00   Class :character   Class :character  
    ##  Median : 8.00   Mode  :character   Mode  :character  
    ##  Mean   : 9.84                                        
    ##  3rd Qu.:16.00                                        
    ##  Max.   :21.00

``` r
insta_df = instacart
```

## How many aisles are there and which aisles are the most items ordered from?

``` r
num_aisle = insta_df %>% 
  group_by(aisle) %>% 
  summarise(total_num = n()) %>% 
  arrange(desc(total_num))

nrow(num_aisle)
```

    ## [1] 134

``` r
names(which.max(table(insta_df$aisle)))
```

    ## [1] "fresh vegetables"

``` r
num_aisle %>% 
  filter(total_num > 10000) %>% 
  ggplot() +
  geom_bar(aes(x = total_num, y = aisle), stat = "identity") +
  labs(title = "Number of Orders for Different Aisles",
       x = "Type of Aisel",
       y = "Number of Order") +
  theme_classic()
```

![](p8105_hw3_jz3571_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

``` r
three_pop_df = insta_df %>% 
  filter(aisle == c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle, product_name) %>% 
  summarise(count = n()) %>% 
  mutate(rank = min_rank(desc(count))) %>% 
  filter(rank <= 3) %>% 
  arrange(aisle, rank)
```

    ## `summarise()` has grouped output by 'aisle'. You can override using the
    ## `.groups` argument.

``` r
three_pop_df
```

    ## # A tibble: 9 × 4
    ## # Groups:   aisle [3]
    ##   aisle                      product_name                            count  rank
    ##   <chr>                      <chr>                                   <int> <int>
    ## 1 baking ingredients         Light Brown Sugar                         157     1
    ## 2 baking ingredients         Pure Baking Soda                          140     2
    ## 3 baking ingredients         Organic Vanilla Extract                   122     3
    ## 4 dog food care              Organix Grain Free Chicken & Vegetable…    14     1
    ## 5 dog food care              Organix Chicken & Brown Rice Recipe        13     2
    ## 6 dog food care              Original Dry Dog                            9     3
    ## 7 packaged vegetables fruits Organic Baby Spinach                     3324     1
    ## 8 packaged vegetables fruits Organic Raspberries                      1920     2
    ## 9 packaged vegetables fruits Organic Blueberries                      1692     3

``` r
mean_hr_df = insta_df %>% 
  filter(product_name %in% c("Pink Lady Apples", 'Coffee Ice Cream')) %>% 
  select(order_dow, order_hour_of_day, product_name) %>% 
  group_by(order_dow, product_name) %>% 
  summarise(mean(order_hour_of_day)) %>% 
  mutate(order_dow = recode(order_dow,
                            '0' = 'Sunday',
                            '1' = 'Monday',
                            '2' = 'Tuesday',
                            '3' = 'Wednesday',
                            '4' = 'Thursday',
                            '5' = 'Friday',
                            '6' = 'Saturday'))
```

    ## `summarise()` has grouped output by 'order_dow'. You can override using the
    ## `.groups` argument.

``` r
mean_hr_df
```

    ## # A tibble: 14 × 3
    ## # Groups:   order_dow [7]
    ##    order_dow product_name     `mean(order_hour_of_day)`
    ##    <chr>     <chr>                                <dbl>
    ##  1 Sunday    Coffee Ice Cream                      13.8
    ##  2 Sunday    Pink Lady Apples                      13.4
    ##  3 Monday    Coffee Ice Cream                      14.3
    ##  4 Monday    Pink Lady Apples                      11.4
    ##  5 Tuesday   Coffee Ice Cream                      15.4
    ##  6 Tuesday   Pink Lady Apples                      11.7
    ##  7 Wednesday Coffee Ice Cream                      15.3
    ##  8 Wednesday Pink Lady Apples                      14.2
    ##  9 Thursday  Coffee Ice Cream                      15.2
    ## 10 Thursday  Pink Lady Apples                      11.6
    ## 11 Friday    Coffee Ice Cream                      12.3
    ## 12 Friday    Pink Lady Apples                      12.8
    ## 13 Saturday  Coffee Ice Cream                      13.8
    ## 14 Saturday  Pink Lady Apples                      11.9
